<!DOCTYPE HTML SYSTEM "-//Macromedia//DWExtension layout-engine 5.0//dialog">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>Corner Insert</title>

</head>
<script language="JavaScript">
	function isDOMRequired() { 
		// Return false, indicating that this object is available in code view.
		return false;
	}

	function objectTag() {
		
		//取得当前浏览的dom
		var dom = dw.getDocumentDOM();
		
		//属性名称，用于生成id标签例如:entity.id中的id
		var insertTag="";
		//包含改属性的实体的名称,录入:entity.id中的entity
		var objectName = "";
		
		if (document.insertTagform.insertTag.value != ""){
			insertTag = document.insertTagform.insertTag.value;
		}
		else {
			//取得选中的位置
			var domSelection = dom.getSelection();
			if(domSelection != null && domSelection.length==2){
				if(domSelection[0] != domSelection[1]){
					insertTag = dom.source.getText(domSelection[0],domSelection[1]);
				} else{
					insertTag = "id";
				}
			} else{
					insertTag = "id";
			}
		}
		
		var idInsTag = insertTag.charAt(0).toUpperCase()+insertTag.substring(1,insertTag.length);
		var valTag = insertTag.charAt(0).toLowerCase()+insertTag.substring(1,insertTag.length);
		
		//实体名称录入框的值
		var inputObjectName = document.insertTagform.objectName.value;
		if (inputObjectName != ""){
			objectName=inputObjectName;
		}
		else {
			objectName='entity'; 
		}
		
		//手动实现再选中的文本外围增加span标签
		if(valTag.indexOf("get")>-1){
			dom.source.wrapSelection("<span jwcid=\"@Insert\" value=\"ognl:"+valTag+"("+inputObjectName+")\">","</span>");//如果输入get方法
		} else {
			dom.source.wrapSelection("<span jwcid=\"@Insert\" value=\"ognl:"+objectName+"."+valTag+"\">","</span>");//如果是属性
		}
		return;        
		

	}

	function displayHelp(){
		dreamweaver.browseDocument("mailto:Ghostbb@bjmaxinfo.com");
	}
	
	function focusObject(){
		var obj = document.getElementById("insertTag");
		obj.focus();
	}
</script>
<body onload="focusObject()">
<form action="" method="post" name="insertTagform" id="insertTagform">
 <table width="380" border="0" cellspacing="3" cellpadding="2" align="center">
  <tr>
  <td align="left"><font face="新宋体" size="2">实体名称(默认为:entity)</font></td>
   <td>
     <input type="text" name="objectName" id="objectName">
   </td>
   </tr>
   <tr>
   <td align="left"><font face="新宋体" size="2">字段名称(默认为:idField)</font></td>
   <td>
     <input type="text" name="insertTag" id="insertTag">
   </td>
  </tr>
 </table>
 <hr>
<p align="center">bjmaxinfo'Ghostbb</p>
</form>
</body>
</html>
